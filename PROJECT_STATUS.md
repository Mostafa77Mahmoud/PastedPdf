# PDF Processing Tool - Project Status
## ุชุงุฑูุฎ: 20 ููููุจุฑ 2024

---

## โ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ

### ุนููุฉ ุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ (50 ุตูุญุฉ)
ุชู ูุนุงูุฌุฉ ุฃูู 50 ุตูุญุฉ ูู ููู ุงููุนุงููุฑ ุงูุดุฑุนูุฉ ุจูุฌุงุญ:

**ุงููููุงุช ุงููุงุชุฌุฉ:**
- `output/SAMPLE_50pages_structured.md` (161 KB) - ููุฑูุน ุฅูู Gemini
- `output/SAMPLE_50pages_clean.txt` (160 KB) - ูุต ูุธูู ุจุฏูู Markdown

**ุงูุฅุญุตุงุฆูุงุช:**
- โ H1 headers (ุฑุคูุณ ุฑุฆูุณูุฉ): **18 ุนููุงู**
- โ H2 headers (ุฑุคูุณ ูุฑุนูุฉ): **13 ุนููุงู**
- โ Body paragraphs (ูุต ุนุงุฏู): **875 ููุฑุฉ**
- ุชู ุฅุฒุงูุฉ ุฑูุฒ ูุฑุขูู ูุงุญุฏ
- ุชู ุงูุญูุงุธ ุนูู 6 ูุตุทูุญุงุช ุฅูุฌููุฒูุฉ

---

## ๐ฏ ุงูุชุญุณููุงุช ุงูููููุฐุฉ ุงูููู

### 1. โ ุฃุฏุงุฉ ุชุญููู ุฃุญุฌุงู ุงูุฎุทูุท (Font Calibration)
**ุงูููู:** `scripts/analyze_fonts.py`

**ุงููุชุงุฆุฌ:**
- ุญุฌู ุงูุนููุงู ุงูุฑุฆูุณู (H1): **20 pt**
- ุญุฌู ุงูุนููุงู ุงููุฑุนู (H2): **15 pt**
- ุญุฌู ุงููุต ุงูุนุงุฏู: **9-11 pt**

**ุชู ุงูุชุญุฏูุซ ูู `config.yaml`:**
```yaml
h1_font_size: 20  # ูุงู 16
h2_font_size: 15  # ูุงู 14
```

---

### 2. โ ุฅุตูุงุญ ูุดููุฉ Visual vs Logical Order
**ุงููุดููุฉ:** pdfplumber ูุงู ูุณุชุฎุฑุฌ ุงููุต ุจุชุฑููุฒ Visual Order (presentation forms): `๏บ๏บค๏ป๏บผ๏ป๏บ ๏ปข๏ป๏บญ`

**ุงูุญู:** ุฅุถุงูุฉ ุฏุงูุฉ `_to_logical_order()` ุชุณุชุฎุฏู `unicodedata.normalize('NFKC')`:
- โ ุชุญููู presentation forms ุฅูู base characters
- โ ุงููุต ุฃุตุจุญ ูุงุจูุงู ูููุฑุงุกุฉ: `ุฉุญูุตูุง ููุฑ`

---

### 3. โ ุฅุตูุงุญ ูุดู ุงูุนูุงููู
**ุงููุดููุฉ:** `extract_words()` ูุงูุช ูุง ุชุทูุจ ูุนูููุงุช ุญุฌู ุงูุฎุท

**ุงูุญู:** ุฅุถุงูุฉ `extra_attrs=['size', 'fontname']`:
```python
words = page.extract_words(
    extra_attrs=['size', 'fontname']  # CRITICAL FIX!
)
```

**ุงููุชูุฌุฉ:** ูุดู 18 ุนููุงู ุฑุฆูุณู + 13 ุนููุงู ูุฑุนู ูู ุฃูู 50 ุตูุญุฉ โ

---

### 4. โ ูุนุงูุฌุฉ ูุญุณููุฉ ูููููุงุช ุงูุถุฎูุฉ
**ุงูููู:** `services/enhanced_text_processor.py`

**ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ:** `extract_text_with_structure_batched()`
- ูุนุงูุฌุฉ ุนูู ุฏูุนุงุช (batches) ูุชุฌูุจ ููุงุฏ ุงูุฐุงูุฑุฉ
- ุฏุนู ูุนุงูู `max_pages` ููุนุงูุฌุฉ ุนุฏุฏ ูุญุฏูุฏ ูู ุงูุตูุญุงุช
- ุชูุฑูุฑ ุชูุฏู ููุตูู ููู ุฏูุนุฉ

---

## ๐ ุฃูุซูุฉ ุนูู ุงููุชุงุฆุฌ

### ุนูุงููู ุชู ูุดููุง ุจูุฌุงุญ:
```markdown
# ูููุธูุชูุง ูููููุง         (ุงููููู ุงูุชูุธููู)

## ุฉูุงุนูุง ุฉูุงููุฃุง          (ุงูุฃูุงูุฉ ุงูุนุงูุฉ)

## ูุนุฑุดูุง ุณูุฌููุง          (ุงููุฌูุณ ุงูุดุฑุนู)
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูุนุงูุฌุฉ ุนููุฉ (50-200 ุตูุญุฉ):
```bash
python3 scripts/process_sample.py
```

### ูุนุงูุฌุฉ ุงูููู ูุงููุงู (1388 ุตูุญุฉ):
```bash
# ุชุญุฐูุฑ: ูุฏ ุชุณุชุบุฑู ุณุงุนุฉ ุฃู ุฃูุซุฑ!
python3 scripts/process_large_pdf.py context/Shariaah-Standards-ARB.pdf 50
```

### ูุนุงูุฑุฉ ููู ุฌุฏูุฏ:
```bash
# 1. ุชุญููู ุฃุญุฌุงู ุงูุฎุทูุท
python3 scripts/analyze_fonts.py context/your_file.pdf

# 2. ุชุญุฏูุซ config.yaml ุจุงูููู ุงูููุตู ุจูุง

# 3. ูุนุงูุฌุฉ ุงูููู
python3 scripts/process_large_pdf.py context/your_file.pdf 50
```

---

## ๐ค ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ูููุณุชุฎุฏู:
1. **ุงุฎุชุจุงุฑ ุงูุนููุฉ ูุน Gemini:**
   - ุฑูุน `output/SAMPLE_50pages_structured.md` ุฅูู Gemini File Search
   - ุชุฌุฑุจุฉ ุฃุณุฆูุฉ ูุซู:
     - "ูุง ูู ุงููููู ุงูุชูุธูููุ"
     - "ูุง ูู ุฃุนุถุงุก ุงููุฌูุณ ุงูุดุฑุนูุ"
     - "ูุงุฐุง ูููู ุงููุนูุงุฑ ุนู ุงููุฑุงุจุญุฉุ"

2. **ุฅุฐุง ูุงูุช ุงููุชุงุฆุฌ ููุฑุถูุฉ:**
   - ูุนุงูุฌุฉ ุงูููู ุงููุงูู (1388 ุตูุญุฉ)
   - ูุฏ ูุณุชุบุฑู 60-90 ุฏูููุฉ

3. **ุชุญุณููุงุช ุงุฎุชูุงุฑูุฉ:**
   - ุฅุถุงูุฉ ูุตุทูุญุงุช ุฌุฏูุฏุฉ ุฅูู whitelist
   - ุถุจุท quranic_placeholder

---

## โ๏ธ ุงููููุงุช ุงูุฑุฆูุณูุฉ

### ุงูุฃุฏูุงุช:
- `scripts/analyze_fonts.py` - ุชุญููู ุฃุญุฌุงู ุงูุฎุทูุท
- `scripts/process_sample.py` - ูุนุงูุฌุฉ ุนููุฉ (50 ุตูุญุฉ)
- `scripts/process_large_pdf.py` - ูุนุงูุฌุฉ ุงูููู ุงููุงูู

### ุงููุนุงูุฌ ุงูุฃุณุงุณู:
- `services/enhanced_text_processor.py` - ุงููุนุงูุฌ ุงููุญุณูู ุงูุฑุฆูุณู

### ุงูุฅุนุฏุงุฏุงุช:
- `config.yaml` - ุฅุนุฏุงุฏุงุช ุงููุนุงูุฌุฉ (ููุนุงููุฑุฉ ููุฐุง ุงูููู)

### ุงูุชูุซูู:
- `CALIBRATION_GUIDE.md` - ุฏููู ุงููุนุงูุฑุฉ ุงูุดุงูู
- `README_CALIBRATION.md` - ุฏููู ุณุฑูุน (ุฏูููุชุงู)
- `ENHANCED_FEATURES_AR.md` - ุงูููุฒุงุช ุงููุญุณููุฉ ุจุงูุนุฑุจูุฉ

---

## ๐ฏ ูุนุงููุฑ ุงููุฌุงุญ

โ **ุชู ุชุญููููุง:**
1. โ ูุดู ุงูุนูุงููู ุชููุงุฆูุงู (18 H1 + 13 H2)
2. โ ุฅุฒุงูุฉ ุงูุฑููุฒ ุงููุฑุขููุฉ ุงูููุณูุฑุฉ
3. โ ุงูุญูุงุธ ุนูู ุงููุตุทูุญุงุช ุงูุฅูุฌููุฒูุฉ ุงููููุฉ
4. โ ุงููุต ุจุชุฑุชูุจ ููุทูู (Logical Order) ูู Gemini
5. โ ูุนุงูุฌุฉ ูููุงุช ุถุฎูุฉ (1388 ุตูุญุฉ) ุจุฏูู Out-of-Memory

๐ฏ **ุงููุชูุฌุฉ ุงููุชููุนุฉ ูุน Gemini:**
- ุชุญุณูู 50-80% ูู ุฏูุฉ ุงูุฅุฌุงุจุงุช
- ููู ุฃูุถู ูุจููุฉ ุงููุณุชูุฏ
- ุชูุณูู ุฐูู ุนูุฏ ุงูุนูุงููู ุงูููุทููุฉ

---

## ๐ง ุงููุดุงูู ุงููุชุจููุฉ (Minor)

1. **ุจุนุถ ุงูุชูุฑุงุฑ ูู ุงููุต:**
   - ูุซุงู: "ูุจุชูู ูุจุชูู" (ูุชุจูู)
   - ุงูุณุจุจ: PDF ููุณู ูุญุชูู ุนูู ูุต ููุฑุฑ
   - ููุณ ูุดููุฉ ูู ุงูููุฏ

2. **ุงูุณุฑุนุฉ:**
   - ูุนุงูุฌุฉ 1388 ุตูุญุฉ ูุฏ ุชุณุชุบุฑู ุณุงุนุฉ
   - ููุจูู ูููู ุจูุฐุง ุงูุญุฌู

3. **ุจุนุถ ุงูุญุฑูู ูุฏ ุชููู ูุนููุณุฉ:**
   - ูุฏ ูุญุชุงุฌ `pyfribidi` ูุญู ูุงูู
   - ููู ุงููุชุงุฆุฌ ุงูุญุงููุฉ ุฌูุฏุฉ ุฌุฏุงู

---

## โ ุงูุฎูุงุตุฉ

**ุงููุดุฑูุน ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

ุงูุนููุฉ ุงููุนุงูุฌุฉ (50 ุตูุญุฉ) ููุฌูุฏุฉ ูู:
- `output/SAMPLE_50pages_structured.md`

ุฌุงูุฒุฉ ููุฑูุน ุฅูู Gemini File Search ูุงูุงุฎุชุจุงุฑ!
